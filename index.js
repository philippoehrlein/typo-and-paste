(function(){"use strict";const t=window.Vue;function x(){return window.panel}const M=()=>window.panel.plugins.viewButtons!==void 0,R=t.computed;t.customRef,t.defineAsyncComponent,t.defineComponent,t.effectScope,t.getCurrentInstance;const V=t.getCurrentScope;t.h,t.inject,t.isProxy,t.isReactive,t.isReadonly,t.isRef,t.isShallow,t.markRaw;const L=t.nextTick;t.onActivated,t.onBeforeMount,t.onBeforeUnmount,t.onBeforeUpdate,t.onDeactivated,t.onErrorCaptured;const O=t.onMounted;t.onRenderTracked,t.onRenderTriggered;const U=t.onScopeDispose;t.onServerPrefetch,t.onUnmounted,t.onUpdated,t.provide,t.proxyRefs,t.reactive,t.readonly;const C=t.ref;t.shallowReactive,t.shallowReadonly,t.shallowRef,t.toRaw,t.toRef,t.toRefs,t.triggerRef;const q=t.unref;t.useAttrs,t.useCssModule,t.useCssVars,t.useListeners,t.useSlots;const j=t.watch;t.watchEffect,t.watchPostEffect,t.watchSyncEffect;let w;async function T(){if(w)return w;try{w=await window.panel.api.get("typo-and-paste/characters")}catch(r){console.error("Error loading characters:",r),w=[]}return w}function $(r){return Object.prototype.toString.call(r)==="[object Object]"}function D(r,e,a,n,o,u,i,h){var p=typeof r=="function"?r.options:r;return e&&(p.render=e,p.staticRenderFns=a,p._compiled=!0),u&&(p._scopeId="data-v-"+u),{exports:r,options:p}}const F={__name:"CharacterSelector",props:{characters:{type:Array,required:!0},languageCode:{type:String,required:!0},type:{type:String,default:"dropdown"}},emits:["close"],setup(r,{emit:e}){const a=r,n=x(),o=C(),u=C(),i=C(!1),h=C(),p=a.type==="dialog"?12:8,m=R(()=>a.characters.map(s=>{var _;let c;$(s.label)?c=s.label[((_=n.user)==null?void 0:_.language)||"en"]:c=s.label;const g=s.characters.map(l=>{var f;let y=l,d=y;return $(l)&&(l.value&&(y=l.value),l.label&&(d=$(l.label)?l.label[((f=n.user)==null?void 0:f.language)||"en"]||y:l.label)),{label:d,value:y}});return{...s,characters:g,label:c}}));O(async()=>{var c,g,_;await L();const s=await window.panel.api.get("/typo-and-paste/enable-search");h.value=window.panel.plugins.components["k-typo-search-and-paste-dialog"],h.value&&s.value&&(i.value=s.value),(_=(g=(c=u.value)==null?void 0:c[0])==null?void 0:g.$el)==null||_.focus()});function b(s){navigator.clipboard.writeText(s),a.type==="dialog"?n.dialog.close():e("close"),n.notification.info({message:n.t("philippoehrlein.typo-and-paste.copiedMessage",{character:s}),icon:void 0})}function k(s){var P,E;s.key!=="Enter"&&s.stopPropagation();const c=o.value,g=document.activeElement.closest(".tap-characters__section, .search-section");if(!g)return;const _=[...g.querySelectorAll(".tap-characters__item")],l=_.indexOf(document.activeElement),y=c.indexOf(g);if(l===-1&&y===-1)return;let d,f;switch(s.key){case"ArrowRight":s.preventDefault(),d=l+1,d<_.length&&_[d].focus();break;case"ArrowLeft":s.preventDefault(),d=l-1,d>=0&&_[d].focus();break;case"ArrowDown":s.preventDefault(),d=l+p,d>=_.length?(f=y+1,f<c.length&&v(c[f])):_[d].focus();break;case"ArrowUp":s.preventDefault(),d=l-p,d<0?(f=y-1,f>=0&&S(c[f])):_[d].focus();break;case"Enter":case"Space":if(s.preventDefault(),l!==-1)if(g.classList.contains("search-section"))I();else{const ce=_[l].textContent.trim();b(ce)}break;case"Tab":s.preventDefault(),s.shiftKey?(f=y-1,f<0?i.value?(P=document.querySelector(".search-section .tap-characters__item"))==null||P.focus():S(c.at(-1)):S(c[f])):(f=y+1,f>=c.length?i.value?(E=document.querySelector(".search-section .tap-characters__item"))==null||E.focus():v(c[0]):v(c[f]));break;case"Escape":e("close");break}}function v(s){var c;(c=s.querySelector(".tap-characters__item"))==null||c.focus()}function S(s){var g;(g=[...s.querySelectorAll(".tap-characters__item")].at(-1))==null||g.focus()}function I(){window.panel.dialog.open({component:"k-typo-search-and-paste-dialog"})}return{__sfc:!0,props:a,emit:e,panel:n,charactersSections:o,characterButtons:u,enableSearch:i,searchDialog:h,GRID_COLUMNS:p,resolvedCharacters:m,copyToClipboard:b,handleKeyNavigation:k,focusFirstButtonInSection:v,focusLastButtonInSection:S,openSearchDialog:I}}};var K=function(){var e=this,a=e._self._c,n=e._self._setupProxy;return e.characters.length?a("div",{staticClass:"tap-characters",class:[e.type!=="dialog"&&"tap-characters--dropdown"],attrs:{tabindex:"-1"}},[e._l(n.resolvedCharacters,function(o,u){return[!o.lang||o.lang===e.languageCode?a("section",{key:u,ref:"charactersSections",refInFor:!0,staticClass:"tap-characters__section"},[o.label?a("h3",[e._v(" "+e._s(o.label)+" ")]):e._e(),a("div",{staticClass:"tap-characters__items",style:{"--grid-columns":n.GRID_COLUMNS},on:{keydown:n.handleKeyNavigation}},e._l(o.characters,function(i){return a("k-button",{key:i.value,ref:"characterButtons",refInFor:!0,staticClass:"tap-characters__item",attrs:{tabindex:"0",role:"menuitem",title:i.label},on:{click:function(h){return n.copyToClipboard(i.value)}}},[e._v(" "+e._s(i.value)+" ")])}),1)]):e._e()]}),n.enableSearch?a("section",{key:n.resolvedCharacters.length,staticClass:"search-section"},[a("k-button",{staticClass:"tap-characters__item",attrs:{icon:"search",size:"sm"},on:{click:n.openSearchDialog}},[e._v(" Search ")])],1):e._e()],2):e._e()},H=[],z=D(F,K,H,!1,null,"b1169a85");const B=z.exports,N={__name:"DropdownButton",setup(r){const e=x(),a=C(),n=C([]),o=C(!1),u=R(()=>{var h,p;return((h=e.language)==null?void 0:h.code)||((p=e.user)==null?void 0:p.language)||"en"});(async()=>n.value=await T())();function i(){a.value.toggle(),o.value=!o.value}return{__sfc:!0,panel:e,dropdownContent:a,characters:n,isOpen:o,languageCode:u,toggle:i,CharacterSelector:B}}};var G=function(){var e=this,a=e._self._c,n=e._self._setupProxy;return a("div",[a("k-button",{attrs:{dropdown:!0,title:n.panel.t("philippoehrlein.typo-and-paste.buttonTitle"),variant:"filled",size:"sm",icon:"typo-and-paste","aria-haspopup":"menu","aria-expanded":n.isOpen},on:{click:function(o){return n.toggle()}}}),a("k-dropdown-content",{ref:"dropdownContent",attrs:{"align-x":"end",role:"menu"}},[a(n.CharacterSelector,{attrs:{characters:n.characters,"language-code":n.languageCode},on:{close:function(o){return n.toggle()}}})],1)],1)},W=[],Z=D(N,G,W,!1,null,null);const A=Z.exports,J={__name:"TypoAndPasteDialog",emits:["cancel","close","input","submit","success"],setup(r,{emit:e}){const a=x(),n=C([]),o=R(()=>{var u,i;return((u=a.language)==null?void 0:u.code)||((i=a.user)==null?void 0:i.language)||"en"});return(async()=>n.value=await T())(),{__sfc:!0,emit:e,panel:a,characters:n,languageCode:o,CharacterSelector:B}}};var Q=function(){var e=this,a=e._self._c,n=e._self._setupProxy;return a("k-dialog",{staticClass:"k-typo-and-paste-dialog",attrs:{"cancel-button":!1,"submit-button":!1,visible:!0,size:"medium",role:"dialog","aria-labelledby":"typo-and-paste-dialog-title"},on:{cancel:function(o){return n.emit("cancel")}}},[a("h2",{staticClass:"sr-only",attrs:{id:"typo-and-paste-dialog-title"}},[e._v(" "+e._s(n.panel.t("philippoehrlein.typo-and-paste.dialogTitle","Special Characters"))+" ")]),a("p",{staticClass:"sr-only"},[e._v(" "+e._s(n.panel.t("philippoehrlein.typo-and-paste.dialogDescription","Up and down to navigate between sections, left and right to navigate between characters."))+" ")]),a(n.CharacterSelector,{attrs:{characters:n.characters,"language-code":n.languageCode,type:"dialog"}})],1)},X=[],Y=D(J,Q,X,!1,null,null);const ee=Y.exports;function te(r,e,a,n){let o;const u=()=>{o==null||o(),o=void 0},i=(m,b,k,v)=>(m.addEventListener(b,k,v),()=>m.removeEventListener(b,k,v)),h=j(()=>ne(r),m=>{u(),m&&(o=i(m,e,a,n))},{immediate:!0,flush:"post"}),p=()=>{h(),u()};return V()&&U(p),p}function ne(r){const e=q(r);return(e==null?void 0:e.$el)??e}const ae={"typo-and-paste":'<path d="M10.931 22C9.57512 22 8.37089 21.7948 7.31831 21.3845C6.28357 20.9563 5.47183 20.3498 4.8831 19.5648C4.29437 18.7798 4 17.8432 4 16.7549C4 15.5239 4.31221 14.5427 4.93662 13.8113C5.56103 13.062 6.33709 12.5446 7.26479 12.2592V12.1521C6.46197 11.7596 5.78404 11.2512 5.23099 10.6268C4.69577 9.98451 4.42817 9.11925 4.42817 8.03098C4.42817 6.94272 4.70469 6.02394 5.25775 5.27465C5.82864 4.52535 6.62254 3.96338 7.63944 3.58873C8.65634 3.19624 9.84272 3 11.1986 3C12.5188 3 13.6784 3.20516 14.6775 3.61549C15.6944 4.02582 16.4883 4.61455 17.0592 5.38169C17.63 6.13099 17.9155 7.01408 17.9155 8.03098V8.48591H15.5606V8.19155C15.5427 7.46009 15.3376 6.86244 14.9451 6.39859C14.5704 5.9169 14.0531 5.56901 13.393 5.35493C12.7507 5.123 12.0014 5.00704 11.1451 5.00704C10.5742 5.00704 10.03 5.06948 9.51268 5.19437C8.99531 5.30141 8.53146 5.47981 8.12113 5.72958C7.72864 5.97934 7.41643 6.30939 7.18451 6.71972C6.95258 7.11221 6.83662 7.5939 6.83662 8.16479C6.83662 8.89624 7.01502 9.50282 7.37183 9.98451C7.72864 10.4484 8.19249 10.7962 8.76338 11.0282C9.35211 11.2601 9.98545 11.3761 10.6634 11.3761H12.3225V13.3296H10.7169C10.0033 13.3296 9.31643 13.4188 8.65634 13.5972C7.99624 13.7756 7.46103 14.1056 7.0507 14.5873C6.65822 15.0512 6.46197 15.7202 6.46197 16.5944C6.46197 17.3972 6.6493 18.0484 7.02394 18.5479C7.41643 19.0474 7.96056 19.4131 8.65634 19.6451C9.36995 19.877 10.1906 19.993 11.1183 19.993C12.1174 19.993 12.9469 19.8681 13.607 19.6183C14.2671 19.3685 14.7577 18.985 15.0789 18.4676C15.4 17.9502 15.5606 17.3169 15.5606 16.5676V11.3761H20.1901V13.3563H17.9155V16.4873C17.9155 17.6648 17.6479 18.6639 17.1127 19.4845C16.5953 20.3052 15.8192 20.9296 14.7845 21.3577C13.7498 21.7859 12.4653 22 10.931 22Z" />'},oe={"typo-and-paste":{icon:"typo-and-paste",label:"Typo & Paste",click(){window.panel.dialog.open({component:"k-typo-and-paste-dialog"})}}},se={"typo-and-paste":{get button(){return{icon:"typo-and-paste",label:"Typo & Paste"}},commands(){return()=>{window.panel.dialog.open({component:"k-typo-and-paste-dialog"})}},get name(){return"typo-and-paste"}}};function re(r){if(M())return;let e;r.mixin({mounted(){if(this.$options.name!=="k-header")return;const a=this.$children.find(o=>o.$options.name==="k-button-group");if(!a)return;const n=r.extend(A);e=new n({parent:this}),e.$mount(),a.$el.prepend(e.$el)},beforeDestroy(){this.$options.name==="k-header"&&e&&(e.$destroy(),e=void 0)}})}window.panel.plugin("philippoehrlein/typo-and-paste",{icons:ae,components:{"k-typo-and-paste-dialog":ee},viewButtons:{"typo-and-paste":A},textareaButtons:oe,writerMarks:se,use:[function(){te(window,"keydown",r=>{!r.altKey||r.code!=="KeyT"||window.panel.dialog.open({component:"k-typo-and-paste-dialog"})})},re]})})();
