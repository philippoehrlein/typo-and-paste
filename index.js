(function(){"use strict";const t=window.Vue;function S(){return window.panel}const E=()=>window.panel.plugins.viewButtons!==void 0,x=t.computed;t.customRef,t.defineAsyncComponent,t.defineComponent,t.effectScope,t.getCurrentInstance;const M=t.getCurrentScope;t.h,t.inject,t.isProxy,t.isReactive,t.isReadonly,t.isRef,t.isShallow,t.markRaw;const V=t.nextTick;t.onActivated,t.onBeforeMount,t.onBeforeUnmount,t.onBeforeUpdate,t.onDeactivated,t.onErrorCaptured;const L=t.onMounted;t.onRenderTracked,t.onRenderTriggered;const O=t.onScopeDispose;t.onServerPrefetch,t.onUnmounted,t.onUpdated,t.provide,t.proxyRefs,t.reactive,t.readonly;const m=t.ref;t.shallowReactive,t.shallowReadonly,t.shallowRef,t.toRaw,t.toRef,t.toRefs,t.triggerRef;const U=t.unref;t.useAttrs,t.useCssModule,t.useCssVars,t.useListeners,t.useSlots;const q=t.watch;t.watchEffect,t.watchPostEffect,t.watchSyncEffect;let b;async function D(){if(b)return b;try{b=await window.panel.api.get("typo-and-paste/characters")}catch(r){console.error("Error loading characters:",r),b=[]}return b}function R(r){return Object.prototype.toString.call(r)==="[object Object]"}function $(r,e,a,n,o,u,i,h){var f=typeof r=="function"?r.options:r;return e&&(f.render=e,f.staticRenderFns=a,f._compiled=!0),u&&(f._scopeId="data-v-"+u),{exports:r,options:f}}const j={__name:"CharacterSelector",props:{characters:{type:Array,required:!0},languageCode:{type:String,required:!0},type:{type:String,default:"dropdown"}},emits:["close"],setup(r,{emit:e}){const a=r,n=S(),o=m(),u=m(),i=m(!1),h=a.type==="dialog"?12:8,f=x(()=>a.characters.map(s=>{var g;let c;R(s.label)?c=s.label[((g=n.user)==null?void 0:g.language)||"en"]:c=s.label;const _=s.characters.map(l=>{var d;let y=l,p=y;return R(l)&&(l.value&&(y=l.value),l.label&&(p=R(l.label)?l.label[((d=n.user)==null?void 0:d.language)||"en"]||y:l.label)),{label:p,value:y}});return{...s,characters:_,label:c}}));L(async()=>{var s,c,_;await V(),(_=(c=(s=u.value)==null?void 0:s[0])==null?void 0:c.$el)==null||_.focus(),i.value=window.panel.plugins.components["k-typo-search-and-paste-dialog"]!==void 0});function C(s){navigator.clipboard.writeText(s),a.type==="dialog"?n.dialog.close():e("close"),n.notification.info({message:n.t("philippoehrlein.typo-and-paste.copiedMessage",{character:s}),icon:void 0})}function k(s){var I,P;s.key!=="Enter"&&s.stopPropagation();const c=o.value,_=document.activeElement.closest(".tap-characters__section, .search-section");if(!_)return;const g=[..._.querySelectorAll(".tap-characters__item")],l=g.indexOf(document.activeElement),y=c.indexOf(_);if(l===-1&&y===-1)return;let p,d;switch(s.key){case"ArrowRight":s.preventDefault(),p=l+1,p<g.length&&g[p].focus();break;case"ArrowLeft":s.preventDefault(),p=l-1,p>=0&&g[p].focus();break;case"ArrowDown":s.preventDefault(),p=l+h,p>=g.length?(d=y+1,d<c.length&&v(c[d])):g[p].focus();break;case"ArrowUp":s.preventDefault(),p=l-h,p<0?(d=y-1,d>=0&&w(c[d])):g[p].focus();break;case"Enter":case"Space":if(s.preventDefault(),l!==-1)if(_.classList.contains("search-section"))A();else{const re=g[l].textContent.trim();C(re)}break;case"Tab":s.preventDefault(),s.shiftKey?(d=y-1,d<0?i.value?(I=document.querySelector(".search-section .tap-characters__item"))==null||I.focus():w(c.at(-1)):w(c[d])):(d=y+1,d>=c.length?i.value?(P=document.querySelector(".search-section .tap-characters__item"))==null||P.focus():v(c[0]):v(c[d]));break;case"Escape":e("close");break}}function v(s){var c;(c=s.querySelector(".tap-characters__item"))==null||c.focus()}function w(s){var _;(_=[...s.querySelectorAll(".tap-characters__item")].at(-1))==null||_.focus()}function A(){window.panel.dialog.open({component:"k-typo-search-and-paste-dialog"})}return{__sfc:!0,props:a,emit:e,panel:n,charactersSections:o,characterButtons:u,enableSearch:i,GRID_COLUMNS:h,resolvedCharacters:f,copyToClipboard:C,handleKeyNavigation:k,focusFirstButtonInSection:v,focusLastButtonInSection:w,openSearchDialog:A}}};var F=function(){var e=this,a=e._self._c,n=e._self._setupProxy;return e.characters.length?a("div",{staticClass:"tap-characters",class:[e.type!=="dialog"&&"tap-characters--dropdown"],attrs:{tabindex:"-1"}},[e._l(n.resolvedCharacters,function(o,u){return[!o.lang||o.lang===e.languageCode?a("section",{key:u,ref:"charactersSections",refInFor:!0,staticClass:"tap-characters__section"},[o.label?a("h3",[e._v(" "+e._s(o.label)+" ")]):e._e(),a("div",{staticClass:"tap-characters__items",style:{"--grid-columns":n.GRID_COLUMNS},on:{keydown:n.handleKeyNavigation}},e._l(o.characters,function(i){return a("k-button",{key:i.value,ref:"characterButtons",refInFor:!0,staticClass:"tap-characters__item",attrs:{tabindex:"0",role:"menuitem",title:i.label},on:{click:function(h){return n.copyToClipboard(i.value)}}},[e._v(" "+e._s(i.value)+" ")])}),1)]):e._e()]}),n.enableSearch?a("section",{key:n.resolvedCharacters.length,staticClass:"search-section"},[a("k-button",{staticClass:"tap-characters__item",attrs:{icon:"search",size:"sm"},on:{click:n.openSearchDialog}},[e._v(" Search ")])],1):e._e()],2):e._e()},K=[],H=$(j,F,K,!1,null,"d82b1daa");const T=H.exports,z={__name:"DropdownButton",setup(r){const e=S(),a=m(),n=m([]),o=m(!1),u=x(()=>{var h,f;return((h=e.language)==null?void 0:h.code)||((f=e.user)==null?void 0:f.language)||"en"});(async()=>n.value=await D())();function i(){a.value.toggle(),o.value=!o.value}return{__sfc:!0,panel:e,dropdownContent:a,characters:n,isOpen:o,languageCode:u,toggle:i,CharacterSelector:T}}};var N=function(){var e=this,a=e._self._c,n=e._self._setupProxy;return a("div",[a("k-button",{attrs:{dropdown:!0,title:n.panel.t("philippoehrlein.typo-and-paste.buttonTitle"),variant:"filled",size:"sm",icon:"typo-and-paste","aria-haspopup":"menu","aria-expanded":n.isOpen},on:{click:function(o){return n.toggle()}}}),a("k-dropdown-content",{ref:"dropdownContent",attrs:{"align-x":"end",role:"menu"}},[a(n.CharacterSelector,{attrs:{characters:n.characters,"language-code":n.languageCode},on:{close:function(o){return n.toggle()}}})],1)],1)},G=[],W=$(z,N,G,!1,null,null);const B=W.exports,Z={__name:"TypoAndPasteDialog",emits:["cancel","close","input","submit","success"],setup(r,{emit:e}){const a=S(),n=m([]),o=x(()=>{var u,i;return((u=a.language)==null?void 0:u.code)||((i=a.user)==null?void 0:i.language)||"en"});return(async()=>n.value=await D())(),{__sfc:!0,emit:e,panel:a,characters:n,languageCode:o,CharacterSelector:T}}};var J=function(){var e=this,a=e._self._c,n=e._self._setupProxy;return a("k-dialog",{staticClass:"k-typo-and-paste-dialog",attrs:{"cancel-button":!1,"submit-button":!1,visible:!0,size:"medium",role:"dialog","aria-labelledby":"typo-and-paste-dialog-title"},on:{cancel:function(o){return n.emit("cancel")}}},[a("h2",{staticClass:"sr-only",attrs:{id:"typo-and-paste-dialog-title"}},[e._v(" "+e._s(n.panel.t("philippoehrlein.typo-and-paste.dialogTitle","Special Characters"))+" ")]),a("p",{staticClass:"sr-only"},[e._v(" "+e._s(n.panel.t("philippoehrlein.typo-and-paste.dialogDescription","Up and down to navigate between sections, left and right to navigate between characters."))+" ")]),a(n.CharacterSelector,{attrs:{characters:n.characters,"language-code":n.languageCode,type:"dialog"}})],1)},Q=[],X=$(Z,J,Q,!1,null,null);const Y=X.exports;function ee(r,e,a,n){let o;const u=()=>{o==null||o(),o=void 0},i=(C,k,v,w)=>(C.addEventListener(k,v,w),()=>C.removeEventListener(k,v,w)),h=q(()=>te(r),C=>{u(),C&&(o=i(C,e,a,n))},{immediate:!0,flush:"post"}),f=()=>{h(),u()};return M()&&O(f),f}function te(r){const e=U(r);return(e==null?void 0:e.$el)??e}const ne={"typo-and-paste":'<path d="M10.931 22C9.57512 22 8.37089 21.7948 7.31831 21.3845C6.28357 20.9563 5.47183 20.3498 4.8831 19.5648C4.29437 18.7798 4 17.8432 4 16.7549C4 15.5239 4.31221 14.5427 4.93662 13.8113C5.56103 13.062 6.33709 12.5446 7.26479 12.2592V12.1521C6.46197 11.7596 5.78404 11.2512 5.23099 10.6268C4.69577 9.98451 4.42817 9.11925 4.42817 8.03098C4.42817 6.94272 4.70469 6.02394 5.25775 5.27465C5.82864 4.52535 6.62254 3.96338 7.63944 3.58873C8.65634 3.19624 9.84272 3 11.1986 3C12.5188 3 13.6784 3.20516 14.6775 3.61549C15.6944 4.02582 16.4883 4.61455 17.0592 5.38169C17.63 6.13099 17.9155 7.01408 17.9155 8.03098V8.48591H15.5606V8.19155C15.5427 7.46009 15.3376 6.86244 14.9451 6.39859C14.5704 5.9169 14.0531 5.56901 13.393 5.35493C12.7507 5.123 12.0014 5.00704 11.1451 5.00704C10.5742 5.00704 10.03 5.06948 9.51268 5.19437C8.99531 5.30141 8.53146 5.47981 8.12113 5.72958C7.72864 5.97934 7.41643 6.30939 7.18451 6.71972C6.95258 7.11221 6.83662 7.5939 6.83662 8.16479C6.83662 8.89624 7.01502 9.50282 7.37183 9.98451C7.72864 10.4484 8.19249 10.7962 8.76338 11.0282C9.35211 11.2601 9.98545 11.3761 10.6634 11.3761H12.3225V13.3296H10.7169C10.0033 13.3296 9.31643 13.4188 8.65634 13.5972C7.99624 13.7756 7.46103 14.1056 7.0507 14.5873C6.65822 15.0512 6.46197 15.7202 6.46197 16.5944C6.46197 17.3972 6.6493 18.0484 7.02394 18.5479C7.41643 19.0474 7.96056 19.4131 8.65634 19.6451C9.36995 19.877 10.1906 19.993 11.1183 19.993C12.1174 19.993 12.9469 19.8681 13.607 19.6183C14.2671 19.3685 14.7577 18.985 15.0789 18.4676C15.4 17.9502 15.5606 17.3169 15.5606 16.5676V11.3761H20.1901V13.3563H17.9155V16.4873C17.9155 17.6648 17.6479 18.6639 17.1127 19.4845C16.5953 20.3052 15.8192 20.9296 14.7845 21.3577C13.7498 21.7859 12.4653 22 10.931 22Z" />'},ae={"typo-and-paste":{icon:"typo-and-paste",label:"Typo & Paste",click(){window.panel.dialog.open({component:"k-typo-and-paste-dialog"})}}},oe={"typo-and-paste":{get button(){return{icon:"typo-and-paste",label:"Typo & Paste"}},commands(){return()=>{window.panel.dialog.open({component:"k-typo-and-paste-dialog"})}},get name(){return"typo-and-paste"}}};function se(r){if(E())return;let e;r.mixin({mounted(){if(this.$options.name!=="k-header")return;const a=this.$children.find(o=>o.$options.name==="k-button-group");if(!a)return;const n=r.extend(B);e=new n({parent:this}),e.$mount(),a.$el.prepend(e.$el)},beforeDestroy(){this.$options.name==="k-header"&&e&&(e.$destroy(),e=void 0)}})}window.panel.plugin("philippoehrlein/typo-and-paste",{icons:ne,components:{"k-typo-and-paste-dialog":Y},viewButtons:{"typo-and-paste":B},textareaButtons:ae,writerMarks:oe,use:[function(){ee(window,"keydown",r=>{!r.altKey||r.code!=="KeyT"||window.panel.dialog.open({component:"k-typo-and-paste-dialog"})})},se]})})();
